
import tensorflow as tf
import numpy as np

from ecoroar.scheduler import LinearSchedule


def test_learning_rate():
    lr_schedule = LinearSchedule(0.1, 50)
    lr = np.array([lr_schedule(i).numpy() for i in tf.range(50)])

    np.testing.assert_allclose(lr, [
        0.        , 0.03333334, 0.06666667, 0.1       , 0.09787234, 0.09574468,
        0.09361702, 0.09148937, 0.0893617 , 0.08723404, 0.08510639, 0.08297873,
        0.08085107, 0.07872341, 0.07659575, 0.07446808, 0.07234042, 0.07021277,
        0.0680851 , 0.06595745, 0.06382979, 0.06170213, 0.05957447, 0.05744681,
        0.05531915, 0.05319149, 0.05106383, 0.04893617, 0.04680851, 0.04468085,
        0.04255319, 0.04042554, 0.03829787, 0.03617021, 0.03404255, 0.03191489,
        0.02978723, 0.02765957, 0.02553192, 0.02340426, 0.0212766 , 0.01914894,
        0.01702128, 0.01489362, 0.01276596, 0.0106383 , 0.00851064, 0.00638298,
        0.00425532, 0.00212766
    ], rtol=1e-5, atol=1e-5)
